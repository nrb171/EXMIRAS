function cmap = colortables(varargin)
%COLORTABLES loads a user pre-defined colormap
%
%   cmap = colortables(name)
%
%   Available colortables are:

validColortables = [...
  "WILD",       ... % 25 colors
  "WILD24",     ... % 24 colors
  "CARBONE",    ... % 17 colors
  "CARBONE18",  ... % 18 colors
  "CARBONE16",  ... % 16 colors
  "RADAR16",    ... % 16 colors, from UW radar
  "RADAR18",    ... % 18 colors
  "RADAR32",    ... % 32 colors, extended radar16
  "JETLOG",     ... % 64 colors, Log-based Jet
  "JETLOG2",    ... % 64 colors, Anotherlog-based Jet
  "REDBLUE",    ... % 64 colors red-white-blue
  "REDBLUE2",   ... % 64 colors red-blue
  "NEWBLUE",    ... % 64 colors red-white-blue
  "PuOr",       ... % 64 colors, from purple to orange
  "RdGy",       ... % 64 colors, from grey to red
  "SPRING",     ... % 64 colors,
  "COOL",       ... % 64 colors,
  "HYPERSPECTRAL"]; % black to white to purple to blue to yellow to red to white
%   Several Meteorological variables will be assigned colormaps by default:
validMeteoVariables = [...
  "RadialWind",       ...
  "TangentialWind",   ...
  "VerticalWind",     ...
  "AngularMomentum", ...
  "dBZ"];

%
%   optional parameters:
%   'LogScale'   - "seq"/"div"/false, return colormap with log scale
%             'seq' - sequential colormap
%             'div' - diverging colormap
%   'Resample'   - resample colormap to this number of colors
%
% Output:
%   cmap - colormap (Nx3 ARRAY)
%
% Change Log:
%   2018-09 - Initial Creation
%   2023-10 - rewrite and added 'Resample' and 'LogScale' options






%-------------------------------------------------------------------------------
%%* PARSE INPUT ARGUMENTS ******************************************************


p = inputParser;
p.addRequired('name',@(x) ischar(x) | isstring(x));
p.addParameter('LogScale',false,@(x) ischar(x) | isstring(x));
p.addParameter('Resample',false,@(x) isnumeric(x));
p.parse(varargin{:});
name = p.Results.name;

validateName = validatestring(name,validColortables);


% parse meteo variables
if any(strcmpi(name,validMeteoVariables))
  switch name
    case "dBZ"
      name = ("RADAR32");
      print("Using RADAR32 colormap for dBZ")
      print("set clim([-2*10/6,50])")
  end
end


%-------------------------------------------------------------------------------
%%* DEFINE COLORMAPS ***********************************************************
cmaps.wild = [...
    110/256.0 110/256.0   110/256.0;...
    85/256.0 85/256.0   125/256.0;...
    138/256.0 138/256.0   177/256.0;...
    1/256.0 1/256.0   125/256.0;...
    1/256.0 23/256.0   170/256.0;...
    1/256.0 1/256.0   210/256.0;...
    4/256.0  128/256.0   255/256.0;...
    4/256.0  193/256.0   255/256.0;...
    4/256.0   252/256.0 17/256.0;...
    4/256.0   169/256.0 17/256.0;...
    4/256.0   132/256.0 17/256.0;...
    4/256.0   83/256.0  17/256.0;...
    200/256.0 200/256.0 200/256.0;...
    167/256.0 72/256.0 3/256.0;...
    217/256.0 149/256.0 96/256.0;...
    255/256.0 184/256.0 31/256.0;...
    255/256.0 255/256.0 3/256.0;...
    254/256.0 190/256.0 190/256.0;...
    254/256.0 136/256.0 136/256.0;...
    254/256.0 87/256.0  87/256.0;...
    254/256.0 119/256.0  0/256.0;...
    223/256.0 80/256.0  0/256.0;...
    138/256.0 0/256.0   0/256.0;...
    210/256.0 0/256.0   0/256.0;...
    255/256.0 0/256.0   0/256.0];

cmaps.wild24 = [...
    200/256.0 200/256.0 200/256.0;...
    85/256.0 85/256.0   125/256.0;...
    138/256.0 138/256.0   177/256.0;...
    1/256.0 1/256.0   125/256.0;...
    1/256.0 23/256.0   170/256.0;...
    1/256.0 1/256.0   210/256.0;...
    4/256.0  128/256.0   255/256.0;...
    4/256.0  193/256.0   255/256.0;...
    4/256.0   252/256.0 17/256.0;...
    4/256.0   169/256.0 17/256.0;...
    4/256.0   132/256.0 17/256.0;...
    4/256.0   83/256.0  17/256.0;...
    167/256.0 72/256.0 3/256.0;...
    217/256.0 149/256.0 96/256.0;...
    255/256.0 184/256.0 31/256.0;...
    255/256.0 255/256.0 3/256.0;...
    254/256.0 190/256.0 190/256.0;...
    254/256.0 136/256.0 136/256.0;...
    254/256.0 87/256.0  87/256.0;...
    254/256.0 119/256.0  0/256.0;...
    223/256.0 80/256.0  0/256.0;...
    138/256.0 0/256.0   0/256.0;...
    210/256.0 0/256.0   0/256.0;...
    255/256.0 0/256.0   0/256.0];

cmaps.carbone = [...
    0.539   0.066   0.559;...
    0.293   0.121   0.621;...
    0.461   0.363   0.887;...
    0.437   0.684   0.809;...
    0.066   0.543   0.066;...
    0.125   0.652   0.125;...
    0.430   0.770   0.430;...
    0.633   0.816   0.633;...
    0.906   0.902   0.906;...
    0.984   0.859   0.050;...
    0.984   0.750   0.113;...
    0.879   0.641   0.211;...
    0.750   0.535   0.289;...
    0.629   0.441   0.344;...
    0.871   0.375   0.469;...
    0.945   0.277   0.418;...
    0.809   0.156   0.254];

cmaps.carbone18 = [...
    0.990   0.990   0.990;...
    0.539   0.066   0.559;...
    0.293   0.121   0.621;...
    0.461   0.363   0.887;...
    0.437   0.684   0.809;...
    0.066   0.543   0.066;...
    0.125   0.652   0.125;...
    0.430   0.770   0.430;...
    0.633   0.816   0.633;...
    0.906   0.902   0.906;...
    0.984   0.859   0.050;...
    0.984   0.750   0.113;...
    0.879   0.641   0.211;...
    0.750   0.535   0.289;...
    0.629   0.441   0.344;...
    0.871   0.375   0.469;...
    0.945   0.277   0.418;...
    0.809   0.156   0.254];

cmaps.carbone16 = [...
    0.539   0.066   0.559;...
    0.293   0.121   0.621;...
    0.461   0.363   0.887;...
    0.437   0.684   0.809;...
    0.066   0.543   0.066;...
    0.125   0.652   0.125;...
    0.430   0.770   0.430;...
    0.633   0.816   0.633;...
    0.906   0.902   0.906;...
    0.984   0.859   0.050;...
    0.984   0.750   0.113;...
    0.879   0.641   0.211;...
    0.750   0.535   0.289;...
    0.629   0.441   0.344;...
    0.871   0.375   0.469;...
    0.945   0.277   0.418];

cmaps.radar16 = [...
    250/255 250/255 250/255;...
    0       236/255 236/255;...
    1/255   160/255 246/255;...
    0       0       246/255;...
    20/255 250/255  20/255;...
    0       200/255 0      ;...
    0       144/255 0      ;...
    1       1       0      ;...
    231/255 192/255 0      ;...
    254/255 144/255 0      ;...
    254/255 0       0      ;...
    214/255 0       0      ;...
    192/255 0       0      ;...
    1       0       1      ;...
    153/255  85/255 201/255;...
    124/255 124/255 124/255];

cmaps.jetlog = [...
  0 0 0.5625;0 0 0.7812;0 0 1;0 0.25 1;0 0.5 1;0 0.75 1;0 1 1;0.1667 1 0.8333;0.3333 1 0.6667;0.5 1 0.5;0.6667 1 0.3333;0.8333 1 0.1667;1 1 0;1 0.9231 0;1 0.8462 0;1 0.7692 0;1 0.6923 0;1 0.6154 0;1 0.5385 0;1 0.4615 0;1 0.3846 0;1 0.3077 0;1 0.2308 0;1 0.1538 0;1 0.07692 0;1 0 0;1 0.04306 0.04306;1 0.08612 0.08612;1 0.1292 0.1292;1 0.1722 0.1722;1 0.2153 0.2153;1 0.2584 0.2584;1 0.3014 0.3014;1 0.3445 0.3445;1 0.3876 0.3876;1 0.4306 0.4306;1 0.4737 0.4737;1 0.4932 0.4932;1 0.5127 0.5127;1 0.5322 0.5322;1 0.5517 0.5517;1 0.5712 0.5712;1 0.5906 0.5906;1 0.6101 0.6101;1 0.6296 0.6296;1 0.6491 0.6491;1 0.6686 0.6686;1 0.6881 0.6881;1 0.7076 0.7076;1 0.7271 0.7271;1 0.7466 0.7466;1 0.7661 0.7661;1 0.7856 0.7856;1 0.8051 0.8051;1 0.8246 0.8246;1 0.8441 0.8441;1 0.8635 0.8635;1 0.883 0.883;1 0.9025 0.9025;1 0.922 0.922;1 0.9415 0.9415;1 0.961 0.961;1 0.9805 0.9805;1 1 1];

cmaps.jetlog2 =  [...
  0 0 0.5625;0 0 0.625;0 0 0.6875;0 0 0.75;0 0 0.8125;0 0 0.875;0 0 0.9375;0 0 1;0 0.125 1;0 0.25 1;0 0.375 1;0 0.5 1;0 0.625 1;0 0.75 1;0 0.875 1;0 1 1;0.1111 1 0.8889;0.2222 1 0.7778;0.3333 1 0.6667;0.4444 1 0.5556;0.5556 1 0.4444;0.6667 1 0.3333;0.7778 1 0.2222;0.8889 1 0.1111;1 1 0;1 0.875 0;1 0.75 0;1 0.625 0;1 0.5 0;1 0.375 0;1 0.25 0;1 0.125 0;1 0 0;1 0.03644 0.03644;1 0.07288 0.07288;1 0.1093 0.1093;1 0.1458 0.1458;1 0.1822 0.1822;1 0.2186 0.2186;1 0.2551 0.2551;1 0.2915 0.2915;1 0.3279 0.3279;1 0.3644 0.3644;1 0.4008 0.4008;1 0.4373 0.4373;1 0.4737 0.4737;1 0.5029 0.5029;1 0.5322 0.5322;1 0.5614 0.5614;1 0.5907 0.5907;1 0.6199 0.6199;1 0.6491 0.6491;1 0.6784 0.6784;1 0.7076 0.7076;1 0.7369 0.7369;1 0.7661 0.7661;1 0.7953 0.7953;1 0.8246 0.8246;1 0.8538 0.8538;1 0.883 0.883;1 0.9123 0.9123;1 0.9415 0.9415;1 0.9708 0.9708;1 1 1];


cmaps.redblue2 = [...
  0 0 0.5625;0 0 0.6172;0 0 0.6719;0 0 0.7266;0 0 0.7812;0 0 0.8359;0 0 0.8906;0 0 0.9453;0 0 1;0.0397 0.0397 1;0.07939 0.07939 1;0.1191 0.1191 1;0.1588 0.1588 1;0.1985 0.1985 1;0.2382 0.2382 1;0.2779 0.2779 1;0.3176 0.3176 1;0.3573 0.3573 1;0.397 0.397 1;0.4367 0.4367 1;0.4763 0.4763 1;0.516 0.516 1;0.5557 0.5557 1;0.5954 0.5954 1;0.6351 0.6351 1;0.6748 0.6748 1;0.7145 0.7145 1;0.7542 0.7542 1;0.7939 0.7939 1;0.8336 0.8336 1;0.8733 0.8733 1;0.913 0.913 1;1 0.913 0.913;1 0.8715 0.8715;1 0.83 0.83;1 0.7885 0.7885;1 0.747 0.747;1 0.7055 0.7055;1 0.664 0.664;1 0.6225 0.6225;1 0.581 0.581;1 0.5395 0.5395;1 0.498 0.498;1 0.4565 0.4565;1 0.415 0.415;1 0.3735 0.3735;1 0.332 0.332;1 0.2905 0.2905;1 0.249 0.249;1 0.2075 0.2075;1 0.166 0.166;1 0.1245 0.1245;1 0.083 0.083;1 0.0415 0.0415;1 0 0;0.9444 0 0;0.8889 0 0;0.8333 0 0;0.7778 0 0;0.7222 0 0;0.6667 0 0;0.6111 0 0;0.5556 0 0;0.5 0 0];

cmaps.redblue = [...
   0       0       0.5000;...
   0       0       0.5556;...
   0       0       0.6111;...
   0       0       0.6667;...
   0       0       0.7222;...
   0       0       0.7778;...
   0       0       0.8333;...
   0       0       0.8889;...
   0       0       0.9444;...
   0       0       1     ;...
   0.04348 0.04348 1     ;...
   0.08696 0.08696 1     ;...
   0.1304  0.1304  1     ;...
   0.1739  0.1739  1     ;...
   0.2174  0.2174  1     ;...
   0.2609  0.2609  1     ;...
   0.3043  0.3043  1     ;...
   0.3478  0.3478  1     ;...
   0.3913  0.3913  1     ;...
   0.4348  0.4348  1     ;...
   0.4783  0.4783  1     ;...
   0.5217  0.5217  1     ;...
   0.5652  0.5652  1     ;...
   0.6087  0.6087  1     ;...
   0.6522  0.6522  1     ;...
   0.6957  0.6957  1     ;...
   0.7391  0.7391  1     ;...
   0.7826  0.7826  1     ;...
   0.8261  0.8261  1     ;...
   0.8696  0.8696  1     ;...
   0.913   0.913   1     ;...
   0.9565  0.9565  1     ;...
   1       0.9565  0.9565;...
   1       0.913   0.913 ;...
   1       0.8696  0.8696;...
   1       0.8261  0.8261;...
   1       0.7826  0.7826;...
   1       0.7391  0.7391;...
   1       0.6957  0.6957;...
   1       0.6522  0.6522;...
   1       0.6087  0.6087;...
   1       0.5652  0.5652;...
   1       0.5217  0.5217;...
   1       0.4783  0.4783;...
   1       0.4348  0.4348;...
   1       0.3913  0.3913;...
   1       0.3478  0.3478;...
   1       0.3043  0.3043;...
   1       0.2609  0.2609;...
   1       0.2174  0.2174;...
   1       0.1739  0.1739;...
   1       0.1304  0.1304;...
   1       0.08696 0.08696;...
   1       0.04348 0.04348;...
   1       0       0      ;...
   0.9444  0       0      ;...
   0.8889  0       0      ;...
   0.8333  0       0      ;...
   0.7778  0       0      ;...
   0.7222  0       0      ;...
   0.6667  0       0      ;...
   0.6111  0       0      ;...
   0.5556  0       0      ;...
   0.5000  0       0];


cmaps.newblue = [...
    0         0    0.3765;...
    0.0353    0.0575    0.3791;...
    0.0706    0.1150    0.3817;...
    0.1059    0.1725    0.3843;...
    0.1098    0.1980    0.4235;...
    0.1137    0.2235    0.4627;...
    0.1176    0.2490    0.5020;...
    0.1216    0.2745    0.5412;...
    0.1477    0.3281    0.5974;...
    0.1739    0.3817    0.6536;...
    0.2000    0.4353    0.7098;...
    0.2353    0.4873    0.7441;...
    0.2706    0.5392    0.7784;...
    0.3059    0.5912    0.8127;...
    0.3412    0.6431    0.8471;...
    0.3780    0.6714    0.8635;...
    0.4149    0.6996    0.8800;...
    0.4518    0.7278    0.8965;...
    0.4886    0.7561    0.9129;...
    0.5255    0.7843    0.9294;...
    0.5608    0.8047    0.9388;...
    0.5961    0.8251    0.9482;...
    0.6314    0.8455    0.9576;...
    0.6667    0.8659    0.9671;...
    0.7020    0.8863    0.9765;...
    0.7325    0.8973    0.9773;...
    0.7631    0.9082    0.9780;...
    0.7937    0.9192    0.9788;...
    0.8243    0.9302    0.9796;...
    0.8549    0.9412    0.9804;...
    0.9059    0.9490    0.9902;...
    0.9569    0.9569    1.0000;...
    1.0000    0.9569    0.9569;...
    0.9961    0.9471    0.8235;...
    0.9922    0.9373    0.6902;...
    0.9922    0.9114    0.6329;...
    0.9922    0.8855    0.5757;...
    0.9922    0.8596    0.5184;...
    0.9922    0.8337    0.4612;...
    0.9922    0.8078    0.4039;...
    0.9914    0.7725    0.3608;...
    0.9906    0.7373    0.3176;...
    0.9898    0.7020    0.2745;...
    0.9890    0.6667    0.2314;...
    0.9882    0.6314    0.1882;...
    0.9843    0.5953    0.1835;...
    0.9804    0.5592    0.1788;...
    0.9765    0.5231    0.1741;...
    0.9725    0.4871    0.1694;...
    0.9686    0.4510    0.1647;...
    0.9471    0.3990    0.1627;...
    0.9255    0.3471    0.1608;...
    0.9039    0.2951    0.1588;...
    0.8824    0.2431    0.1569;...
    0.8392    0.1987    0.1516;...
    0.7961    0.1543    0.1464;...
    0.7529    0.1098    0.1412;...
    0.7078    0.1020    0.1304;...
    0.6627    0.0941    0.1196;...
    0.6176    0.0863    0.1088;...
    0.5725    0.0784    0.0980;...
    0.5072    0.0523    0.0654;...
    0.4418    0.0261    0.0327;...
	      0.3765         0         0];


cmaps.radar32 = [...
    179/255 179/255 179/255;...
    250/255 250/255 250/255;...
    0       236/255 236/255;...
    1/255   199/255 246/255;...
    1/255   160/255 246/255;...
    1/255   122/255 246/255;...
    1/255    84/255 246/255;...
    0       0       246/255;...
    20/255  250/255  20/255;...
    10/255  224/255  10/255;...
    0       200/255 0      ;...
    0       173/255 0      ;...
    0       144/255 0      ;...
    0       117/255 0      ;...
    1       1       0      ;...
    244/255 223/255 0      ;...
    231/255 192/255 0      ;...
    254/255 166/255 0      ;...
    254/255 144/255 0      ;...
    254/255 117/255 0      ;...
    254/255 0       0      ;...
    235/255 0       0      ;...
    214/255 0       0      ;...
    203/255 0       0      ;...
    192/255 0       0      ;...
    179/255 0       0      ;...
    1       0       1      ;...
    204/255  42/255 228/255;...
    153/255  85/255 201/255;...
    102/255 100/255 175/255;...
    124/255 124/255 124/255;...
     44/255  44/255  44/255];

 radar18=[...
 255 255 255;...
 170 255 255;...
  85 160 255;...
  29   0 255;...
 126 229  91;...
  78 204  67;...
  46 178  57;...
  30 153  61;...
 255 255 102;...
 255 204 102;...
 255 136  76;...
 255  25  25;...
 204  61  61;...
 165  49  49;...
 237   0 237;...
 137 103 205;...
 100 100 100;...
 250 240 230]./255;

cmaps.puor = flipud(cbrewer('div','PuOr',64));
cmaps.rdgy = flipud(cbrewer('div','RdGy',64));

cmaps.hyperspectral = [ ...
    flipud(cbrewer('seq','Greys',20)); ...
    [...
      140.0000  150.0000  198.0000
      140.0000  141.4000  193.8000
      140.0000  132.8000  189.6000
      140.0000  124.2000  185.4000
      140.0000  115.6000  181.2000
      140.0000  107.0000  177.0000
      139.2000   98.6000  173.0000
      138.4000   90.2000  169.0000
      137.6000   81.8000  165.0000
      136.8000   73.4000  161.0000

      103.0000  169.0000  207.0000
      93.2000  164.0000  204.0000
      83.4000  159.0000  201.0000
      73.6000  154.0000  198.0000
      63.8000  149.0000  195.0000
      54.0000  144.0000  192.0000
      43.6000  141.0000  181.2000
      33.2000  138.0000  170.4000
      22.8000  135.0000  159.6000
      12.4000  132.0000  148.8000

       223.0000  101.0000  176.0000
       224.6000   89.0000  168.4000
       226.2000   77.0000  160.8000
       227.8000   65.0000  153.2000
       229.4000   53.0000  145.6000
       231.0000   41.0000  138.0000
       226.0000   36.4000  127.6000
       221.0000   31.8000  117.2000
       216.0000   27.2000  106.8000
       211.0000   22.6000   96.4000

       254.0000  153.0000   41.0000
        250.4000  144.8000   36.8000
        246.8000  136.6000   32.6000
        243.2000  128.4000   28.4000
        239.6000  120.2000   24.2000
        236.0000  112.0000   20.0000
        229.6000  104.8000   16.4000
        223.2000   97.6000   12.8000
        216.8000   90.4000    9.2000
        210.4000   83.2000    5.6000

       65.0000  182.0000  196.0000
       57.8000  174.6000  195.2000
       50.6000  167.2000  194.4000
       43.4000  159.8000  193.6000
       36.2000  152.4000  192.8000
       29.0000  145.0000  192.0000
       30.0000  134.8000  187.2000
       31.0000  124.6000  182.4000
       32.0000  114.4000  177.6000
       33.0000  104.2000  172.8000
      ]./255; ...
];

%%* METEO variables
cmaps.radialwind = flipud(cbrewer('div','BrBG',64));
cmaps.tangentialwind = [1-cbrewer('seq','BuPu',16); hot(64)];
cmaps.verticalwind = cmaps.newblue;
cmaps.angularmomentum = flipud(cbrewer('div','PiYG',64));

%-------------------------------------------------------------------------------
cmap = cmaps.(lower(name));

if p.Results.LogScale ~= false
  validatestring(p.Results.LogScale, ["seq", "div"])

  if p.Results.LogScale == "div"
    topLimit = 5;
    range = logspace(log10(1.001),log10(topLimit+1),size(cmap,1)/2)-1;
    range2 = [-fliplr(range),range]';
    % range3 = repmat(range2,1,3);
    cmap2r = interp1(range2, cmap(:,1), linspace(-topLimit,topLimit,size(cmap,1))');
    cmap2g = interp1(range2, cmap(:,2), linspace(-topLimit,topLimit,size(cmap,1))');
    cmap2b = interp1(range2, cmap(:,3), linspace(-topLimit,topLimit,size(cmap,1))');
    cmap = [cmap2r,cmap2g,cmap2b];
  elseif validatestring(p.Results.LogScale, "seq") == "seq"
    topLimit = 5;
    range = logspace(log10(1.001),log10(topLimit+1),size(cmap,1))-1;
    range2 = [range]';
    % range3 = repmat(range2,1,3);
    cmap2r = interp1(range2, cmap(:,1), linspace(-topLimit,topLimit,size(cmap,1))');
    cmap2g = interp1(range2, cmap(:,2), linspace(-topLimit,topLimit,size(cmap,1))');
    cmap2b = interp1(range2, cmap(:,3), linspace(-topLimit,topLimit,size(cmap,1))');
    cmap = [cmap2r,cmap2g,cmap2b];
  end
end

if p.Results.Resample ~= false
  cmap = interp1(1:size(cmap,1), cmap, linspace(1,size(cmap,1),p.Results.Resample), 'PCHIP');
end