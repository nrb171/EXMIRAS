function [varargout] = setMeteoColormap(varargin)
    % setMeteoColormap(ax, variable)
    % setMeteoColormap(variable) (uses gca as current axis)

    if ~isa(varargin{1}, 'matlab.graphics.axis.Axes')
        varargin{2:end+1} = varargin;
        varargin{1} = gca;
    end

    %% RADAR colormaps
        %% Reflectivity colormap
        ColormapInfo.Zhh.aliases = ["Zh", "HorizontalReflectivity", "reflectivity"];
        ColormapInfo.Zhh.clim = 1.5*[-2*10/6,50];
        ColormapInfo.Zhh.cticks = 0:15:75;
        ColormapInfo.Zhh.units = 'dBZ';
        ColormapInfo.Zhh.colormap = [...
            179/255 179/255 179/255;...
            250/255 250/255 250/255;...
            0       236/255 236/255;...
            1/255   199/255 246/255;...
            1/255   160/255 246/255;...
            1/255   122/255 246/255;...
            1/255    84/255 246/255;...
            0       0       246/255;...
            20/255  250/255  20/255;...
            10/255  224/255  10/255;...
            0       200/255 0      ;...
            0       173/255 0      ;...
            0       144/255 0      ;...
            0       117/255 0      ;...
            1       1       0      ;...
            244/255 223/255 0      ;...
            231/255 192/255 0      ;...
            254/255 166/255 0      ;...
            254/255 144/255 0      ;...
            254/255 117/255 0      ;...
            254/255 0       0      ;...
            235/255 0       0      ;...
            214/255 0       0      ;...
            203/255 0       0      ;...
            192/255 0       0      ;...
            179/255 0       0      ;...
            1       0       1      ;...
            204/255  42/255 228/255;...
            153/255  85/255 201/255;...
            102/255 100/255 175/255;...
            124/255 124/255 124/255;...
            44/255  44/255  44/255 ...
        ];

        %% Differential Reflectivity colormap
        ColormapInfo.Zdr.aliases = ["DifferentialReflectivity", "ZDR"];
        ColormapInfo.Zdr.clim = [-1,5];
        ColormapInfo.Zdr.cticks = -1:1:5;
        ColormapInfo.Zdr.units = 'dB';
        ColormapInfo.Zdr.colormap = [...
            winter(36); ...
            flipud(autumn(36)); ...
            flipud(cool(36))...
        ];

        %% Radial Velocity colormap
        ColormapInfo.RadialVelocity.aliases = ["Vr", "DopplerVelocity", "DopplerRadialVelocity"];
        ColormapInfo.RadialVelocity.clim = [-25,25];
        ColormapInfo.RadialVelocity.cticks = -25:5:25;
        ColormapInfo.RadialVelocity.units = 'm/s';
        ColormapInfo.RadialVelocity.colormap =  flipud([...
            0.6196    0.0039    0.2588
            0.6627    0.0510    0.2745
            0.7059    0.0941    0.2863
            0.7412    0.1333    0.2941
            0.7765    0.1725    0.3020
            0.8078    0.2078    0.3098
            0.8353    0.2431    0.3098
            0.8588    0.2745    0.3059
            0.8784    0.2980    0.3020
            0.8980    0.3216    0.2902
            0.9176    0.3451    0.2824
            0.9333    0.3686    0.2706
            0.9451    0.3961    0.2667
            0.9569    0.4275    0.2627
            0.9647    0.4627    0.2667
            0.9725    0.5059    0.2824
            0.9804    0.5529    0.3059
            0.9843    0.6000    0.3294
            0.9882    0.6431    0.3569
            0.9922    0.6824    0.3804
            0.9922    0.7137    0.4000
            0.9922    0.7451    0.4235
            0.9961    0.7765    0.4471
            0.9961    0.8039    0.4667
            0.9961    0.8314    0.4941
            0.9961    0.8549    0.5176
            0.9961    0.8784    0.5451
            0.9961    0.9020    0.5804
            0.9961    0.9294    0.6235
            1.0000    0.9569    0.6667
            1.0000    0.9804    0.7098
            1.0000    0.9961    0.7373
            1.0000    1.0000    0.7490
            0.9961    1.0000    0.7373
            0.9843    0.9922    0.7098
            0.9686    0.9882    0.6745
            0.9451    0.9804    0.6353
            0.9255    0.9686    0.6078
            0.9020    0.9608    0.5961
            0.8784    0.9529    0.6000
            0.8510    0.9412    0.6039
            0.8196    0.9255    0.6157
            0.7843    0.9137    0.6235
            0.7451    0.8980    0.6314
            0.7098    0.8824    0.6392
            0.6706    0.8667    0.6431
            0.6275    0.8510    0.6431
            0.5804    0.8353    0.6431
            0.5333    0.8196    0.6431
            0.4863    0.8000    0.6471
            0.4392    0.7804    0.6471
            0.4000    0.7608    0.6471
            0.3608    0.7373    0.6549
            0.3216    0.7059    0.6667
            0.2863    0.6745    0.6863
            0.2510    0.6392    0.7059
            0.2235    0.6039    0.7216
            0.2039    0.5686    0.7373
            0.1961    0.5333    0.7412
            0.2000    0.4980    0.7373
            0.2157    0.4627    0.7294
            0.2392    0.4235    0.7137
            0.2745    0.3882    0.6902
            0.3176    0.3490    0.6667
            0.3686    0.3098    0.6353 ...
        ]);

        ColormapInfo.CorrelationCoefficient.aliases = ["RhoHV", "CC", "CorrelationCoeff"];
        ColormapInfo.CorrelationCoefficient.clim = [0.95, 1];
        ColormapInfo.CorrelationCoefficient.cticks = 0.95:0.01:1;
        ColormapInfo.CorrelationCoefficient.units = '';
        ColormapInfo.CorrelationCoefficient.colormap = flipud(turbo(64));

        ColormapInfo.SpecificDifferentialPhase.aliases = ["Kdp", "SpecificDiffPhase"];
        ColormapInfo.SpecificDifferentialPhase.clim = [-2, 10];
        ColormapInfo.SpecificDifferentialPhase.cticks = [-2:1:10];
        ColormapInfo.SpecificDifferentialPhase.units = 'deg/km';
        ColormapInfo.SpecificDifferentialPhase.colormap = [...
            0.52549022, 0.0627451 , 0.52549022,
            0.0627451 , 0.0627451 , 0.0627451 ,
            0.15294118, 0.15294118, 0.15294118,
            0.23921569, 0.23921569, 0.23921569,
            0.34901962, 0.34901962, 0.34901962,
            0.43921569, 0.43921569, 0.43921569,
            0.40784314, 0.32549021, 0.32156864,
            0.33333334, 0.14901961, 0.14117648,
            0.3019608 , 0.02745098, 0.02352941,
            0.3764706 , 0.04705882, 0.07450981,
            0.43921569, 0.05882353, 0.10980392,
            0.51372552, 0.08235294, 0.14117648,
            0.59215689, 0.10588235, 0.17254902,
            0.68235296, 0.16078432, 0.24313726,
            0.75686276, 0.24705882, 0.3137255 ,
            0.82352942, 0.32549021, 0.40392157,
            0.86274511, 0.39607844, 0.54509807,
            0.90588236, 0.49019608, 0.72549021,
            0.78039217, 0.49411765, 0.71764708,
            0.65490198, 0.50196081, 0.71372551,
            0.55754749, 0.41070651, 0.71845629,
            0.48235294, 0.20784314, 0.74117649,
            0.43921569, 0.16862746, 0.77254903,
            0.43921569, 0.52941179, 0.85882354,
            0.44743231, 0.89859945, 0.9503268 ,
            0.33501402, 0.89393091, 0.7052599 ,
            0.16178027, 0.74204795, 0.29648305,
            0.14117648, 0.80000001, 0.19607843,
            0.14509805, 0.88235295, 0.17647059,
            0.16370993, 0.99215686, 0.16862746,
            0.34154996, 0.99215686, 0.16862746,
            0.52156866, 0.99215686, 0.17647059,
            0.7019608 , 0.99607843, 0.18431373,
            0.88627452, 1.        , 0.2       ,
            0.98039216, 0.92156863, 0.2       ,
            0.97647059, 0.81960785, 0.1882353 ,
            0.97647059, 0.71764708, 0.18039216,
            0.97647059, 0.61960787, 0.17647059,
            0.97254902, 0.49803922, 0.17254902,
            0.97254902, 0.52549022, 0.2       ,
            0.97647059, 0.56078434, 0.22352941,
            0.97647059, 0.58823532, 0.25882354,
            0.97647059, 0.61960787, 0.29411766,
            0.97647059, 0.65882355, 0.34117648,
            0.97647059, 0.6901961 , 0.3764706 ,
            0.98039216, 0.72156864, 0.41568628,
            0.98039216, 0.75686276, 0.45490196,
            0.98039216, 0.79215688, 0.50588238,
            0.98039216, 0.81568629, 0.54509807,
            0.98431373, 0.83137256, 0.58039218,
            0.98431373, 0.84705883, 0.61960787,
            0.98431373, 0.86666667, 0.66274512,
            0.98823529, 0.87843138, 0.7019608 ,
            0.98823529, 0.89411765, 0.73725492,
            0.98823529, 0.90980393, 0.7764706 ,
            0.99215686, 0.9254902 , 0.80784315,
            0.99215686, 0.94509804, 0.85882354,
            0.98823529, 0.94901961, 0.89019608,
            0.98823529, 0.96470588, 0.92156863,
            0.99215686, 0.98101463, 0.96265173,
            0.99215686, 0.99215686, 0.99215686,
            0.99215686, 0.99215686, 0.99215686,
            0.99215686, 0.99215686, 0.99215686,
            1       , 1        , 1        ...
        ];
    
        ColormapInfo.RainRate.aliases = ["RR", "Rain", "RainfallRate"];
        ColormapInfo.RainRate.clim = [0,30];
        ColormapInfo.RainRate.cticks = 0:5:30;
        ColormapInfo.RainRate.units = 'mm/hr';
        ColormapInfo.RainRate.colormap = [...
            1.0000    0.9686    0.9529
            0.9961    0.9451    0.9333
            0.9961    0.9137    0.9020
            0.9922    0.8784    0.8667
            0.9922    0.8275    0.8078
            0.9882    0.7725    0.7529
            0.9843    0.7255    0.7373
            0.9843    0.6824    0.7255
            0.9804    0.6235    0.7098
            0.9765    0.5176    0.6706
            0.9686    0.4078    0.6314
            0.9490    0.3373    0.6157
            0.9137    0.2745    0.6078
            0.8667    0.2039    0.5922
            0.7804    0.0824    0.5412
            0.6824    0.0039    0.4941
            0.6118    0.0039    0.4824
            0.5490    0.0039    0.4745
            0.4784    0.0039    0.4667
            0.3882    0.0039    0.4471 ...
        ];
    %% Thermodynamic colormaps
        %% Heating Rate colormap
        ColormapInfo.HeatingRate.aliases = ["CoolingRate", "dTdt", "HeatingRate"];
        ColormapInfo.HeatingRate.clim = [-log10(16),log10(16)];
        ColormapInfo.HeatingRate.cticks = [-log10([25,20,15,10,5,3,1]+1),0,log10([1,3,5,10,15,20,25]+1)];
        ColormapInfo.HeatingRate.units = 'K/hr';
        ColormapInfo.HeatingRate.cticklabels = {'-25', '-20', '-15', '-10', '-5','-3','-1', '0', '1' '3', '5', '10', '15', '20','25'};
        ColormapInfo.HeatingRate.message = 'Color axis is logarithmic. Use dlog10(data) to convert data to the color axis.';
        ColormapInfo.HeatingRate.colormap = flipud([ ...
            0.6196    0.0039    0.2588
            0.6627    0.0510    0.2745
            0.7059    0.0941    0.2863
            0.7412    0.1333    0.2941
            0.7765    0.1725    0.3020
            0.8078    0.2078    0.3098
            0.8353    0.2431    0.3098
            0.8588    0.2745    0.3059
            0.8784    0.2980    0.3020
            0.8980    0.3216    0.2902
            0.9176    0.3451    0.2824
            0.9333    0.3686    0.2706
            0.9451    0.3961    0.2667
            0.9569    0.4275    0.2627
            0.9647    0.4627    0.2667
            0.9725    0.5059    0.2824
            0.9804    0.5529    0.3059
            0.9843    0.6000    0.3294
            0.9882    0.6431    0.3569
            0.9922    0.6824    0.3804
            0.9922    0.7137    0.4000
            0.9922    0.7451    0.4235
            0.9961    0.7765    0.4471
            0.9961    0.8039    0.4667
            0.9961    0.8314    0.4941
            0.9961    0.8549    0.5176
            0.9961    0.8784    0.5451
            0.9961    0.9020    0.5804
            0.9961    0.9294    0.6235
            1.0000    0.9569    0.6667
            1.0000    0.9804    0.7098
            1.0000    0.9961    0.7373
            1.0000    1.0000    0.7490
            0.9961    1.0000    0.7373
            0.9843    0.9922    0.7098
            0.9686    0.9882    0.6745
            0.9451    0.9804    0.6353
            0.9255    0.9686    0.6078
            0.9020    0.9608    0.5961
            0.8784    0.9529    0.6000
            0.8510    0.9412    0.6039
            0.8196    0.9255    0.6157
            0.7843    0.9137    0.6235
            0.7451    0.8980    0.6314
            0.7098    0.8824    0.6392
            0.6706    0.8667    0.6431
            0.6275    0.8510    0.6431
            0.5804    0.8353    0.6431
            0.5333    0.8196    0.6431
            0.4863    0.8000    0.6471
            0.4392    0.7804    0.6471
            0.4000    0.7608    0.6471
            0.3608    0.7373    0.6549
            0.3216    0.7059    0.6667
            0.2863    0.6745    0.6863
            0.2510    0.6392    0.7059
            0.2235    0.6039    0.7216
            0.2039    0.5686    0.7373
            0.1961    0.5333    0.7412
            0.2000    0.4980    0.7373
            0.2157    0.4627    0.7294
            0.2392    0.4235    0.7137
            0.2745    0.3882    0.6902
            0.3176    0.3490    0.6667
            0.3686    0.3098    0.6353
        ]);

        %% Relative Humidity colormap
        ColormapInfo.RelativeHumidity.aliases = ["RH"];
        ColormapInfo.RelativeHumidity.clim = [0, 100];
        ColormapInfo.RelativeHumidity.cticks = 0:10:100;
        ColormapInfo.RelativeHumidity.units = '%';
        ColormapInfo.RelativeHumidity.colormap = [
            1.0000    0.9686    0.9843
            0.9843    0.9451    0.9725
            0.9686    0.9255    0.9608
            0.9451    0.9059    0.9529
            0.9255    0.8863    0.9412
            0.9020    0.8706    0.9294
            0.8745    0.8510    0.9216
            0.8471    0.8353    0.9137
            0.8157    0.8196    0.9020
            0.7804    0.8000    0.8902
            0.7412    0.7804    0.8824
            0.6980    0.7608    0.8706
            0.6510    0.7412    0.8588
            0.5961    0.7216    0.8471
            0.5294    0.7020    0.8353
            0.4627    0.6824    0.8235
            0.4039    0.6627    0.8118
            0.3529    0.6392    0.8000
            0.3059    0.6118    0.7882
            0.2588    0.5882    0.7725
            0.2118    0.5647    0.7529
            0.1529    0.5490    0.7176
            0.0863    0.5333    0.6588
            0.0314    0.5216    0.6000
            0.0078    0.5059    0.5412
            0.0078    0.4902    0.4902
            0.0039    0.4706    0.4392
            0.0039    0.4471    0.3922
            0.0039    0.4235    0.3490
            0.0039    0.3922    0.3098
            0.0039    0.3569    0.2745
            0.0039    0.3176    0.2392
            0.0039    0.2745    0.2118...
        ];


    fnames = fieldnames(ColormapInfo);
    aliases = cellfun(@(FN) ColormapInfo.(FN).aliases, fnames, 'uniform', 0);

    if isa(varargin{1}, 'matlab.graphics.axis.Axes')
        variableTemp = varargin{2};
        variableIndex = 2;
    else
        variableTemp = varargin{1};
        variableIndex = 1;
    end
    
    inds = cellfun(@(c) any(strcmpi(c, variableTemp)), aliases);
    if any(inds) 
        varargin{variableIndex} = fnames{find(inds, 1)};
    end
    % result = cell2struct(temp, fnames, 1);   %might need ,2) instead of ,1)

    %% PARSE INPUTS
    p = inputParser;
    addRequired(p, 'ax', @(x) isa(x, 'matlab.graphics.axis.Axes'));
    addRequired(p, 'variable', @(x) contains(x, fnames));
    parse(p, varargin{:});
    ax = p.Results.ax;
    variable = p.Results.variable;

    %% SET THE COLORMAP
    colormap(ax, ColormapInfo.(variable).colormap);
    clim(ax, ColormapInfo.(variable).clim);
    fprintf('Colormap set for %s (%s), limits [%g, %g] %s\n', variable, strjoin(ColormapInfo.(variable).aliases, ', '), ColormapInfo.(variable).clim(1), ColormapInfo.(variable).clim(2), ColormapInfo.(variable).units);
    if isfield(ColormapInfo.(variable), 'message')
        fprintf('%s\n', ColormapInfo.(variable).message);
    end

    if nargout == 1
        varargout{1} = ColormapInfo.(variable);
    end
end





